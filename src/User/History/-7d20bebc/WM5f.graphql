query ThreatWorkQueueCurrentUserQuery {
  currentUser {
    _id
    isSuperAdmin
    organization {
      _id
    }
  }
}
query ThreatWorkQueueQuery(
  $first: Int
  $threatId: ID
  $searchText: String
  $severity: ThreatSeverity
  $userMarkedAsSpam: Boolean
  $campaignThreatId: ID
  $organizationId: ID
  $direction: ThreatWorkQueueDirection
) {
  threats: threatsAround(
    filter: {
      severity_eq: $severity
      userModifiers__userMarkedAsSpam_eq: $userMarkedAsSpam
      organizationId_eq: $organizationId
      AND: [
        {
          OR: [
            { email__subject_contains: $searchText }
            { email__from__address_contains: $searchText }
            { email__to__address_contains: $searchText }
          ]
        }
      ]
    }
    sort: [createdAt_DESC]
    first: $first
    threatId: $threatId
    direction: $direction
    campaignThreatId: $campaignThreatId
  ) {
    createdAt
    _id
    severity
    userModifiers {
      userMarkedAsSpam
    }
    feedbackSentAt
    email {
      subject
      from {
        name
        address
      }
    }
    organization {
      _id
      name
    }
    escalationEmail {
      sendDate
    }
    reporterUser {
      _id
      profile {
        firstName
        lastName
      }
      emails {
        address
      }
    }
  }
}
